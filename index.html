<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gemini 2.0 Flash Web App</title>
  <style>
    #responseBox {
      white-space: pre-wrap;
      background-color: #f3f3f3;
      padding: 10px;
      border-radius: 5px;
      max-width: 800px;
      margin-top: 10px;
      font-family: Arial, sans-serif;
    }
    pre {
      background-color: #222;
      color: #eee;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
    code {
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h1>Bheem GPT!</h1>
  <textarea id="userInput" placeholder="Ask something..." rows="5" cols="80"></textarea><br>
  <button onclick="askGemini()">Send</button>
  <div id="responseBox">Response will appear here...</div>

  <script>
    const API_KEY = 'AIzaSyBFEs9MuxDg_BZ3Q1KaUvs137pDHEDr6xg';  // Your Gemini API key

    function formatMarkdownToHTML(markdown) {
      // Convert bold
      markdown = markdown.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
      
      // Convert inline code
      markdown = markdown.replace(/`([^`\n]+)`/g, '<code>$1</code>');

      // Convert code blocks
      markdown = markdown.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, lang, code) => {
        return `<pre><code class="language-${lang || 'plain'}">${escapeHTML(code)}</code></pre>`;
      });

      // Convert newlines to <br> (for paragraphs)
      markdown = markdown.replace(/\n{2,}/g, '</p><p>').replace(/\n/g, '<br>');
      return '<p>' + markdown + '</p>';
    }

    function escapeHTML(str) {
      return str
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    }

    async function askGemini() {
      const userMessage = document.getElementById('userInput').value;
      const responseBox = document.getElementById('responseBox');
      responseBox.innerHTML = "Thinking...";

      try {
        const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=' + API_KEY, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            contents: [{
              parts: [{ text: userMessage }],
              role: 'user'
            }]
          })
        });

        const data = await response.json();
        let reply = data.candidates?.[0]?.content?.parts?.[0]?.text || "No reply.";

        const formattedReply = formatMarkdownToHTML(reply);
        responseBox.innerHTML = formattedReply;

      } catch (error) {
        responseBox.innerText = "Error: " + error.message;
      }
    }
  </script>
</body>
</html>
